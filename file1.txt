some new logic here
another change
fixed bug by user1